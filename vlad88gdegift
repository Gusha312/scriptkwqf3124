-- –§–ê–†–ú –ú–ò–°–°–ò–ô –° –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ú –ü–û–í–¢–û–†–û–ú
local player = game.Players.LocalPlayer
local running = true

-- –¢–æ—á–∫–∏ –¥–ª—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏ –≤ Jungle
local junglePoints = {
    CFrame.new(2434.90479, 279.143066, -1289.48108),
    CFrame.new(2734.90479, 579.143066, -1289.48108),
    CFrame.new(2834.90479, 579.143066, -1289.48108),
    CFrame.new(2438.90479, 279.143066, -1289.48108),
}

-- –¢–æ—á–∫–∏ –¥–ª—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏ –≤ Pride Rocks
local prideRocksPoints = {
    CFrame.new(1990.40833, 497.999023, -281.304352),
    CFrame.new(1795, 198, -281),
    CFrame.new(1990.41833, 199.999023, -283.304352),
    CFrame.new(1795, 198, -281),
}

-- –¢–æ—á–∫–∏ –¥–ª—è Mud –≤ –∫–∞–∂–¥–æ–º —Ä–µ–≥–∏–æ–Ω–µ
local jungleMudPoint = CFrame.new(2434.90479, 279.143066, -1289.48108)
local prideRocksMudPoint = CFrame.new(1795, 198, -281)

-- –¢–æ—á–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ Pride Rocks
local prideRocksStart = CFrame.new(1790.40833, 197.999023, -281.304352)

-- –£–ª—É—á—à–µ–Ω–Ω—ã–π —Ç–µ–ª–µ–ø–æ—Ä—Ç –≤ —Ç–æ—á–∫—É —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
local function teleportTo(cf)
    if not running then
        return false
    end

    local success = false
    local attempts = 0
    local maxAttempts = 3

    while not success and attempts < maxAttempts and running do
        pcall(function()
            if
                player.Character
                and player.Character:FindFirstChild('HumanoidRootPart')
            then
                player.Character.HumanoidRootPart.CFrame = cf
                success = true
            end
        end)

        if not success then
            attempts += 1
            wait(1)
        end
    end

    return success
end

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –º–∏—Å—Å–∏–π –≤ Jungle
local function allJungleMissionsCompleted()
    local missions =
        game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions.Jungle
    return missions.TimePlayed.Value
        and missions.Sniff.Value
        and missions.EatFoodDrinkWater.Value
        and missions.DistanceTravelled.Value
        and missions.ConcealScent.Value
        and missions.AttackOrHealCreatureOrNPC.Value
end

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –º–∏—Å—Å–∏–π –≤ Pride Rocks
local function allPrideRocksMissionsCompleted()
    local missions =
        game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions['Pride Rocks']
    return missions.TimePlayed.Value
        and missions.Sniff.Value
        and missions.EatFoodDrinkWater.Value
        and missions.DistanceTravelled.Value
        and missions.ConcealScent.Value
        and missions.AttackOrHealCreatureOrNPC.Value
end

-- –ü—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∏—Å—Å–∏–∏ –≤ Jungle
local function hasActiveJungleMissions()
    local missions =
        game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions.Jungle
    return not missions.TimePlayed.Value
        or not missions.Sniff.Value
        or not missions.EatFoodDrinkWater.Value
        or not missions.DistanceTravelled.Value
        or not missions.ConcealScent.Value
        or not missions.AttackOrHealCreatureOrNPC.Value
end

-- –ü—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∏—Å—Å–∏–∏ –≤ Pride Rocks
local function hasActivePrideRocksMissions()
    local missions =
        game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions['Pride Rocks']
    return not missions.TimePlayed.Value
        or not missions.Sniff.Value
        or not missions.EatFoodDrinkWater.Value
        or not missions.DistanceTravelled.Value
        or not missions.ConcealScent.Value
        or not missions.AttackOrHealCreatureOrNPC.Value
end

-- –û–∂–∏–¥–∞–Ω–∏–µ —Å–±—Ä–æ—Å–∞ –º–∏—Å—Å–∏–π
local function waitForMissionsReset()
    print("=== –í–°–ï –ú–ò–°–°–ò–ò –í–´–ü–û–õ–ù–ï–ù–´ ===")
    print("–û–∂–∏–¥–∞–µ–º —Å–±—Ä–æ—Å–∞ –º–∏—Å—Å–∏–π (5 –º–∏–Ω—É—Ç)...")
    
    local startTime = tick()
    local checkInterval = 30 -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
    local lastCheckTime = 0
    
    while running do
        local currentTime = tick()
        
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∏—Å—Å–∏–∏ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        if currentTime - lastCheckTime >= checkInterval then
            lastCheckTime = currentTime
            local elapsedMinutes = math.floor((currentTime - startTime) / 60)
            
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∏—Å—Å–∏–∏
            local jungleActive = hasActiveJungleMissions()
            local prideRocksActive = hasActivePrideRocksMissions()
            
            if jungleActive or prideRocksActive then
                print("‚úÖ –ú–∏—Å—Å–∏–∏ —Å–±—Ä–æ—Å–∏–ª–∏—Å—å! –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–∞—Ä–º –∑–∞–Ω–æ–≤–æ...")
                return true
            else
                print("‚è≥ –û–∂–∏–¥–∞–µ–º —Å–±—Ä–æ—Å–∞... –ü—Ä–æ—à–ª–æ " .. elapsedMinutes .. " –º–∏–Ω—É—Ç")
            end
        end
        
        wait(1)
    end
    
    return false
end

-- –ü–†–û–°–¢–ê–Ø –§–£–ù–ö–¶–ò–Ø –î–õ–Ø MUD
local function doMudRoll(region)
    print("=== –ù–ê–ß–ò–ù–ê–ï–ú MUD ROLL –î–õ–Ø " .. region:upper() .. " ===")
    
    local mudMission
    if region == 'Jungle' then
        mudMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions.Jungle.DistanceTravelled
    else
        mudMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions['Pride Rocks'].DistanceTravelled
    end

    if mudMission.Value then
        print("Mud Roll —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω!")
        return true
    end

    -- –¢–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ–º—Å—è –∫ —Ç–æ—á–∫–µ Mud
    local mudPoint = region == 'Jungle' and jungleMudPoint or prideRocksMudPoint
    print("–¢–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ–º—Å—è –∫ Mud —Ç–æ—á–∫–µ...")
    teleportTo(mudPoint)
    wait(2)

    -- –ò—Å–ø–æ–ª—å–∑—É–µ–º Mud 7 —Ä–∞–∑ –ø–æ–¥—Ä—è–¥
    print("–ò—Å–ø–æ–ª—å–∑—É–µ–º Mud 7 —Ä–∞–∑...")
    for i = 1, 7 do
        if not running or mudMission.Value then
            break
        end
        
        pcall(function()
            if region == 'Jungle' then
                -- JUNGLE: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç Mud
                local args = {
                    workspace:WaitForChild("Interactions"):WaitForChild("Mud"):WaitForChild("Mud")
                }
                game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("Mud"):FireServer(unpack(args))
                print("Jungle Mud " .. i .. "/7")
            else
                -- PRIDE ROCKS: –ü–µ—Ä–≤—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π Mud
                local mud = workspace:WaitForChild("Interactions"):WaitForChild("Mud"):GetChildren()[1]
                local args = { mud }
                game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("Mud"):FireServer(unpack(args))
                print("Pride Rocks Mud " .. i .. "/7")
            end
        end)
        
        wait(1)
    end

    wait(3)
    
    if mudMission.Value then
        print("‚úÖ Mud Roll –í–´–ü–û–õ–ù–ï–ù!")
        return true
    else
        print("‚ùå Mud Roll –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º...")
        return false
    end
end

-- DistanceTravelled –¥–ª—è Jungle
local function doJungleDistanceTravelled()
    local distanceMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions.Jungle.DistanceTravelled

    -- –°–Ω–∞—á–∞–ª–∞ Mud Roll
    print("=== –í–´–ü–û–õ–ù–Ø–ï–ú MUD ROLL ===")
    doMudRoll('Jungle')

    -- –ü–æ—Ç–æ–º –¥–∏—Å—Ç–∞–Ω—Ü–∏—è
    print("=== –ù–ê–ß–ò–ù–ê–ï–ú DISTANCE TRAVELLED ===")
    while running and not allJungleMissionsCompleted() and distanceMission.Value == false do
        for i = 1, #junglePoints do
            if not running or allJungleMissionsCompleted() or distanceMission.Value then
                break
            end
            print("–¢–µ–ª–µ–ø–æ—Ä—Ç –∫ —Ç–æ—á–∫–µ " .. i)
            teleportTo(junglePoints[i])
            wait(2)
        end
    end
    
    if distanceMission.Value then
        print("‚úÖ Jungle DistanceTravelled –í–´–ü–û–õ–ù–ï–ù!")
    end
end

-- DistanceTravelled –¥–ª—è Pride Rocks
local function doPrideRocksDistanceTravelled()
    local distanceMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions['Pride Rocks'].DistanceTravelled

    -- –°–Ω–∞—á–∞–ª–∞ Mud Roll
    print("=== –í–´–ü–û–õ–ù–Ø–ï–ú MUD ROLL ===")
    doMudRoll('Pride Rocks')

    -- –ü–æ—Ç–æ–º –¥–∏—Å—Ç–∞–Ω—Ü–∏—è
    print("=== –ù–ê–ß–ò–ù–ê–ï–ú DISTANCE TRAVELLED ===")
    while running and not allPrideRocksMissionsCompleted() and distanceMission.Value == false do
        for i = 1, #prideRocksPoints do
            if not running or allPrideRocksMissionsCompleted() or distanceMission.Value then
                break
            end
            print("–¢–µ–ª–µ–ø–æ—Ä—Ç –∫ —Ç–æ—á–∫–µ " .. i)
            teleportTo(prideRocksPoints[i])
            wait(2)
        end
    end
    
    if distanceMission.Value then
        print("‚úÖ Pride Rocks DistanceTravelled –í–´–ü–û–õ–ù–ï–ù!")
    end
end

-- –ê—Ç–∞–∫–∞ NPC
local function attackNPC(region)
    local lastAttackTime = 0
    local attackCooldown = 5
    
    while running do
        local attackMission
        if region == 'Jungle' then
            attackMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions.Jungle.AttackOrHealCreatureOrNPC
        else
            attackMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions['Pride Rocks'].AttackOrHealCreatureOrNPC
        end

        if attackMission.Value then
            print("–ê—Ç–∞–∫–∞ NPC —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞")
            break
        end

        local currentTime = tick()
        if currentTime - lastAttackTime >= attackCooldown then
            pcall(function()
                local args = {
                    {
                        workspace:WaitForChild("Interactions"):WaitForChild("NPCs"):WaitForChild("Roots"):WaitForChild("RootPart")
                    }
                }
                game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("NPCDamageRemote"):FireServer(unpack(args))
                print("–ê—Ç–∞–∫–æ–≤–∞–ª–∏ NPC")
                lastAttackTime = currentTime
            end)
        end

        wait(1)
    end
end

-- –ï–¥–∞ –∏ –≤–æ–¥–∞
local function eatAndDrink(region)
    while running do
        local eatMission
        if region == 'Jungle' then
            eatMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions.Jungle.EatFoodDrinkWater
        else
            eatMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions['Pride Rocks'].EatFoodDrinkWater
        end

        if eatMission.Value then
            break
        end

        -- –ï–¥–∞ 25 —Ä–∞–∑
        print("–ù–∞—á–∏–Ω–∞–µ–º –µ—Å—Ç—å 25 —Ä–∞–∑...")
        pcall(function()
            local foodFolder = workspace:WaitForChild("Interactions"):WaitForChild("Food")
            local foods = foodFolder:GetChildren()
            
            for i = 1, 25 do
                if not running or eatMission.Value then
                    break
                end
                
                local food = foods[i] or foods[1]
                local args = { food }
                game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("Food"):FireServer(unpack(args))
                print("–°—ä–µ–ª–∏ –µ–¥—É " .. i .. "/25")
                wait(0.3)
            end
        end)

        -- –í–æ–¥–∞
        pcall(function()
            local lake = workspace:WaitForChild("Interactions"):WaitForChild("Lakes"):FindFirstChild("Lake")
            if lake then
                local args = { lake }
                game:GetService('ReplicatedStorage'):WaitForChild('Remotes'):WaitForChild('DrinkRemote'):FireServer(unpack(args))
                print("–í—ã–ø–∏–ª–∏ –≤–æ–¥—É")
            end
        end)

        wait(2)
    end
end

-- Sniff –º–∏—Å—Å–∏—è
local function doSniff(region)
    while running do
        local sniffMission
        if region == 'Jungle' then
            sniffMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions.Jungle.Sniff
        else
            sniffMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions['Pride Rocks'].Sniff
        end

        if sniffMission.Value then
            break
        end

        pcall(function()
            local args = { 1 }
            game:GetService('ReplicatedStorage'):WaitForChild('Remotes'):WaitForChild('SetMissionRemote'):FireServer(unpack(args))
            print("–°–Ω–∏—Ñ—Ñ –≤—ã–ø–æ–ª–Ω–µ–Ω")
        end)
        wait(2)
    end
end

-- ConcealScent –º–∏—Å—Å–∏—è
local function doConcealScent(region)
    while running do
        local concealMission
        if region == 'Jungle' then
            concealMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions.Jungle.ConcealScent
        else
            concealMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions['Pride Rocks'].ConcealScent
        end

        if concealMission.Value then
            break
        end

        pcall(function()
            if region == 'Jungle' then
                -- JUNGLE: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç Mud
                local args = {
                    workspace:WaitForChild("Interactions"):WaitForChild("Mud"):WaitForChild("Mud")
                }
                game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("Mud"):FireServer(unpack(args))
                print("ConcealScent Jungle Mud")
            else
                -- PRIDE ROCKS: –ü–µ—Ä–≤—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π Mud
                local mud = workspace:WaitForChild("Interactions"):WaitForChild("Mud"):GetChildren()[1]
                local args = { mud }
                game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("Mud"):FireServer(unpack(args))
                print("ConcealScent Pride Rocks Mud")
            end
        end)
        wait(2)
    end
end

-- TimePlayed
local function waitForTimePlayed(region)
    while running do
        local timeMission
        if region == 'Jungle' then
            timeMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions.Jungle.TimePlayed
        else
            timeMission = game:GetService('Players')[player.Name].PlayerGui.Data.Missions.RegionMissions['Pride Rocks'].TimePlayed
        end

        if timeMission.Value then
            break
        end
        wait(5)
    end
end

-- –§–∞—Ä–º —Ä–µ–≥–∏–æ–Ω–∞
local function farmRegion(region)
    local points = region == 'Jungle' and junglePoints or prideRocksPoints

    teleportTo(points[1])
    wait(1)

    print("=== –ù–ê–ß–ò–ù–ê–ï–ú " .. region:upper() .. " ===")
    
    if region == 'Jungle' then
        doJungleDistanceTravelled()
    else
        doPrideRocksDistanceTravelled()
    end

    -- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –º–∏—Å—Å–∏–∏
    coroutine.wrap(function() attackNPC(region) end)()
    coroutine.wrap(function() eatAndDrink(region) end)()
    coroutine.wrap(function() doSniff(region) end)()
    coroutine.wrap(function() doConcealScent(region) end)()
    coroutine.wrap(function() waitForTimePlayed(region) end)()

    -- –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
    local checkFunction = region == 'Jungle' and allJungleMissionsCompleted or allPrideRocksMissionsCompleted
    while running and not checkFunction() do
        wait(1)
    end

    return checkFunction()
end

-- –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º —Ü–∏–∫–ª–æ–º
local function startFarming()
    print("üöÄ –ó–ê–ü–£–°–ö –§–ê–†–ú–ê –ú–ò–°–°–ò–ô...")
    
    -- –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª —Ñ–∞—Ä–º–∞
    while running do
        -- Jungle
        local jungleCompleted = farmRegion('Jungle')

        -- Pride Rocks
        if jungleCompleted and running then
            print("üîÑ –ü–ï–†–ï–•–û–î –í PRIDE ROCKS")
            if teleportTo(prideRocksStart) then
                wait(2)
                local prideRocksCompleted = farmRegion('Pride Rocks')
                
                -- –ï—Å–ª–∏ –æ–±–∞ —Ä–µ–≥–∏–æ–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω—ã, –∂–¥–µ–º —Å–±—Ä–æ—Å–∞ –º–∏—Å—Å–∏–π
                if prideRocksCompleted and running then
                    print("üéâ –í–°–ï –ú–ò–°–°–ò–ò –í–´–ü–û–õ–ù–ï–ù–´!")
                    wait(3)
                    
                    -- –ñ–¥–µ–º —Å–±—Ä–æ—Å–∞ –º–∏—Å—Å–∏–π
                    if not waitForMissionsReset() then
                        break -- –ï—Å–ª–∏ –≤—ã—à–ª–∏ –∏–∑ –æ–∂–∏–¥–∞–Ω–∏—è
                    end
                    
                    -- –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–∞—Ä–º –∑–∞–Ω–æ–≤–æ
                    print("=== –ó–ê–ü–£–°–ö–ê–ï–ú –§–ê–†–ú –ó–ê–ù–û–í–û ===")
                end
            end
        else
            break
        end
    end

    print("‚èπÔ∏è –§–ê–†–ú –û–°–¢–ê–ù–û–í–õ–ï–ù")
end

-- –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–∞—Ä–º —Å—Ä–∞–∑—É
startFarming()

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (–º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏)
function stopFarming()
    running = false
    print("–§–∞—Ä–º –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
end

print('–§–ê–†–ú –ú–ò–°–°–ò–ô –ó–ê–ü–£–©–ï–ù! –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤–≤–µ–¥–∏—Ç–µ: stopFarming()')
