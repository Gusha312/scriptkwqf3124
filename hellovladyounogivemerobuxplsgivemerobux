-- –ü–æ–ª—É—á–∞–µ–º –≤–µ–±—Ö—É–∫ –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π
local DISCORD_WEBHOOK = _G.Discord or "https://discord.com/api/webhooks/1458175374310773022/6CySzBLqZwamvppCi-BtywbO2OQ6ukXd3lMADvdfGyYNnIRk9aqA7JJJebfcqXDKj5Of"

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

-- –î–û–ë–ê–í–õ–ï–ù–û: –õ–∏–º–∏—Ç –º–æ–Ω–µ—Ç –¥–ª—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏ –≤ –æ–±—ã—á–Ω—ã–π –º–∏—Ä
local COINS_LIMIT_FOR_NORMAL_WORLD = 1000  -- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω—É–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

-- –î–û–ë–ê–í–õ–ï–ù–û: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç—Ä–µ–π–¥-–º–∏—Ä–∞)
local COS_STATS_WEBHOOK = "https://discord.com/api/webhooks/1444688891448922305/sVqazCRydGmdq8Gb2AJCIkyddT2_LxYFIn8ytNZACFkNYAefxAZzMxt9p5t7kmFMt9bZ"
local COS_UPDATE_INTERVAL = 300  -- 5 –º–∏–Ω—É—Ç
local COS_INITIAL_DELAY = 2

print("ü§ñ –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω!")

-- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–∏–π –ø–ª–µ–π—Å ID - –ò–°–ü–†–ê–í–õ–ï–ù–û
local currentPlaceId = game.PlaceId
local isTradeWorld = currentPlaceId == 14119723130  -- –¢—Ä–µ–π–¥ –º–∏—Ä
local isNormalWorld = currentPlaceId == 5233782396   -- –û–±—ã—á–Ω—ã–π –º–∏—Ä

if isTradeWorld then
    print("üéØ –û–±–Ω–∞—Ä—É–∂–µ–Ω –¢–†–ï–ô–î –ú–ò–† (14119723130) - –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω CoS Stat-Sender")
    print("üìä CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç")
elseif isNormalWorld then
    print("üåç –û–±–Ω–∞—Ä—É–∂–µ–Ω –û–ë–´–ß–ù–´–ô –ú–ò–† (5233782396) - –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–Ω—ã")
    print("üìä –ü—Ä–æ—Å—Ç–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç")
else
    print("‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –º–∏—Ä: " .. currentPlaceId)
end

-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ FPS –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
local MAX_FPS = 360
local MIN_FPS = 5
local RENDER = true

local localPlayer = Players.LocalPlayer

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–æ–Ω–µ—Ç
local function getCoins()
    local success, coins = pcall(function()
        return localPlayer.Data.Coins.Value
    end)
    
    if success then
        return coins
    else
        warn("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç")
        return 0
    end
end

-- –î–û–ë–ê–í–õ–ï–ù–ê: –§—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–∏—Å–µ–ª
local function formatNumber(value)
    local str = tostring(value)
    return str:reverse():gsub("(%d%d%d)", "%1."):reverse():gsub("^%.", "")
end

-- –§—É–Ω–∫—Ü–∏—è —Å–±–æ—Ä–∞ –æ–±—ã—á–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (—Ç–æ–ª—å–∫–æ –≥—Ä–∏–±—ã) - –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –º–∏—Ä–∞
local function getSimpleStats()
    local coins = getCoins()
    local playerName = localPlayer.Name
    
    local message = string.format([[
üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê
üçÑ –ì—Ä–∏–±–æ–≤: %s
üë§ –ù–∏–∫ –≤ Roblox: %s

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Ä¢ %s
]], 
    formatNumber(coins),
    playerName,
    os.date("%d.%m.%Y, –≤ %H:%M")
    )
    
    return message
end

-- –î–û–ë–ê–í–õ–ï–ù–ê: –§—É–Ω–∫—Ü–∏—è —Å–±–æ—Ä–∞ CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Ç—Ä–µ–π–¥-–º–∏—Ä–µ)
local function getCoSStats()
    if not isTradeWorld then
        return nil
    end
    
    local username = localPlayer.Name
    local displayName = localPlayer.DisplayName
    
    local success, data = pcall(function()
        return localPlayer:WaitForChild("Data")
    end)
    
    if not success then
        warn("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å Data –∏–≥—Ä–æ–∫–∞ –¥–ª—è CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏")
        return nil
    end
    
    local revives = data.Items.CreatureReviveToken.Value
    local maxGrows = data.Items.FullGrowToken.Value
    local shooms = data.Coins.Value
    local turnover = data.MarketStalls.ShoomsRaised.Value
    
    -- –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ë–ï–ó –∑–≤–µ–∑–¥–æ—á–µ–∫
    local message = string.format([[
–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ê–ö–ö–ê–£–ù–¢–ê (CoS):
üë§ –ù–∏–∫: %s (@%s)

ü¶¥ –†–µ–≤–∞–π–≤-—Ç–æ–∫–µ–Ω—ã: %s
üå± –§—É–ª–ª-–≥—Ä–æ—É —Ç–æ–∫–µ–Ω—ã: %s
üçÑ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä–∏–±–æ—á–∫–æ–≤: %s üçÑ
üè™ –û–±–æ—Ä–æ—Ç –≤ –ª–∞–≤–∫–µ: %s üçÑ

‚è∞ –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: %s
üîÑ –°–ª–µ–¥—É—é—â–µ–µ —á–µ—Ä–µ–∑: 5 –º–∏–Ω—É—Ç
]], 
    displayName, 
    username, 
    formatNumber(revives), 
    formatNumber(maxGrows), 
    formatNumber(shooms), 
    formatNumber(turnover),
    os.date("%H:%M:%S")
    )
    
    return message
end

-- –î–û–ë–ê–í–õ–ï–ù–ê: –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (—Ç–æ–ª—å–∫–æ –≤ —Ç—Ä–µ–π–¥-–º–∏—Ä–µ)
local function sendCoSStats()
    if not isTradeWorld then
        return
    end
    
    local success, content = pcall(getCoSStats)
    if not success then 
        print("‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö CoS: " .. tostring(content))
        return 
    end

    if not content then
        return
    end

    local success, errorMsg = pcall(function()
        local response = request({
            Url = COS_STATS_WEBHOOK,
            Method = "POST",
            Headers = {
                ["Content-Type"] = "application/json"
            },
            Body = HttpService:JSONEncode({["content"] = content})
        })
        return response
    end)
    
    if success then
        print("‚úÖ CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ Discord!")
    else
        warn("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: " .. tostring(errorMsg))
    end
end

-- –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–µ–±—Ö—É–∫–∞ –≤ Discord (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –º–∏—Ä–æ–≤)
local function sendDiscordWebhook()
    if isTradeWorld then
        print("üö´ –í–µ–±—Ö—É–∫ –æ—Ç–∫–ª—é—á–µ–Ω –≤ —Ç—Ä–µ–π–¥-–º–∏—Ä–µ")
        return false
    end
    
    local success, content = pcall(getSimpleStats)
    if not success then 
        print("‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö: " .. tostring(content))
        return 
    end
    
    local success, errorMsg = pcall(function()
        local response = request({
            Url = DISCORD_WEBHOOK,
            Method = "POST",
            Headers = {
                ["Content-Type"] = "application/json"
            },
            Body = HttpService:JSONEncode({["content"] = content})
        })
        return response
    end)
    
    if success then
        print("‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ Discord!")
        return true
    else
        warn("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–µ–±—Ö—É–∫–∞: " .. tostring(errorMsg))
        return false
    end
end

-- –î–û–ë–ê–í–õ–ï–ù–ê: –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (—Ç–æ–ª—å–∫–æ –≤ —Ç—Ä–µ–π–¥-–º–∏—Ä–µ)
local function startCoSStatsTimer()
    if not isTradeWorld then
        print("üö´ CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ (–Ω–µ —Ç—Ä–µ–π–¥-–º–∏—Ä)")
        return
    end
    
    print("üöÄ CoS Stat-Sender –∑–∞–ø—É—â–µ–Ω (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç—Ä–µ–π–¥-–º–∏—Ä–∞)!")
    task.wait(COS_INITIAL_DELAY)
    
    -- –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
    sendCoSStats()
    
    while isTradeWorld do
        -- –ñ–¥–µ–º —É–∫–∞–∑–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª, –Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è –ª–∏ –º–∏—Ä
        for i = 1, COS_UPDATE_INTERVAL do
            if game.PlaceId ~= 14119723130 then
                print("üåç –ú–∏—Ä –∏–∑–º–µ–Ω–∏–ª—Å—è, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É")
                return
            end
            wait(1)
        end
        
        sendCoSStats()
    end
end

-- –¢–∞–π–º–µ—Ä –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–µ–±—Ö—É–∫–∞ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –º–∏—Ä–æ–≤)
local function startWebhookTimer()
    if isTradeWorld then
        print("üö´ –¢–∞–π–º–µ—Ä –≤–µ–±—Ö—É–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω –≤ —Ç—Ä–µ–π–¥-–º–∏—Ä–µ")
        return
    end
    
    -- –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
    sendDiscordWebhook()
    
    while isNormalWorld do
        wait(1800) -- 30 –º–∏–Ω—É—Ç
        sendDiscordWebhook()
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ FPS –ª–∏–º–∏—Ç–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)
local function setFpsCap(fps)
    if type(setfpscap) == "function" then
        setfpscap(fps)
        print("üéØ FPS –ª–∏–º–∏—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: " .. fps)
    else
        print("‚ö†Ô∏è –§—É–Ω–∫—Ü–∏—è setfpscap –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞")
    end
end

-- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è FPS –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ/–ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞ –æ–∫–Ω–∞
UserInputService.WindowFocused:Connect(function()
    if RENDER then
        RunService:Set3dRenderingEnabled(true)
        print("üñ•Ô∏è –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤–∫–ª—é—á–µ–Ω")
    end
    setFpsCap(MAX_FPS)
end)

UserInputService.WindowFocusReleased:Connect(function()
    if RENDER then
        RunService:Set3dRenderingEnabled(false)
        print("üîá –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –æ—Ç–∫–ª—é—á–µ–Ω")
    end
    setFpsCap(MIN_FPS)
end)

-- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
if RENDER then
    RunService:Set3dRenderingEnabled(true)
end
setFpsCap(MAX_FPS)

-- –¢–æ–ª—å–∫–æ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –º–∏—Ä–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
local MarketRemotes, ClaimStall, stallCFrames

if isNormalWorld then
    MarketRemotes = ReplicatedStorage:WaitForChild("Remotes")
    ClaimStall = MarketRemotes:WaitForChild("ClaimStall")

    stallCFrames = {
        CFrame.new(-115.76767, 31.4889774, -83.580658, -0.882971644, -0.469426453, -1.34855509e-05, 1.34855509e-05, -5.41210175e-05, 1, -0.469426453, 0.882971644, 5.40614128e-05),
        CFrame.new(-80.3615417, 31.4889774, -23.9790859, -0.0349992514, -0.999387324, 4.3451786e-05, -4.3451786e-05, 4.50015068e-05, 1, -0.999387324, 0.0349992514, -4.50611115e-05),
        CFrame.new(-85.1257629, 31.4889774, 0.639569223, 0.342006564, -0.939697623, -7.00354576e-06, -7.00354576e-06, -1.00135803e-05, 1, -0.939697623, -0.342006564, -1.00135803e-05),
        CFrame.new(-142.565216, 31.4889774, -92.6095505, -0.99452734, -0.104477406, 2.75298953e-06, -2.75298953e-06, 5.2511692e-05, 1, -0.104477406, 0.99452728, -5.25712967e-05),
        CFrame.new(-168.641525, 31.4889774, -90.8674011, -0.97028327, 0.241971374, -2.48849392e-06, 2.48849392e-06, 2.02655792e-05, 0.99999994, 0.241971374, 0.970283329, -2.02655792e-05),
        CFrame.new(-191.504898, 31.4889774, -81.1337967, -0.787993431, 0.615683556, 1.41859055e-05, -1.41859055e-05, -4.12464142e-05, 1, 0.615683556, 0.78799355, 4.12464142e-05),
        CFrame.new(-160.504944, 31.4889774, 46.381073, 0.99452728, 0.104477406, -2.75298953e-06, -2.75298953e-06, 5.2511692e-05, 1, 0.104477406, -0.99452728, 5.2511692e-05),
        CFrame.new(-134.42865, 31.4889774, 44.6389275, 0.970283389, -0.241971403, 2.48104334e-06, 2.48104334e-06, 2.01463699e-05, 1.00000012, -0.241971403, -0.970283508, 2.01463699e-05),
        CFrame.new(-187.302505, 31.4889774, 37.3521729, 0.882971585, 0.469426453, 1.34855509e-05, 1.34855509e-05, -5.41210175e-05, 1, 0.469426453, -0.882971644, -5.41210175e-05),
        CFrame.new(-111.565277, 31.4889774, 34.9053154, 0.78799355, -0.615683556, -1.41859055e-05, -1.41859055e-05, -4.12464142e-05, 1, -0.615683556, -0.78799355, -4.12464142e-05)
    }
end

-- –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è marketStalls (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –º–∏—Ä–æ–≤)
local function getMarketStalls()
    if isTradeWorld then
        return nil
    end
    
    local success, result = pcall(function()
        if not workspace:FindFirstChild("Interactable") then
            return nil, "Interactable –Ω–µ –Ω–∞–π–¥–µ–Ω"
        end
        
        local interactable = workspace.Interactable
        if not interactable:FindFirstChild("MarketStalls") then
            return nil, "MarketStalls –Ω–µ –Ω–∞–π–¥–µ–Ω"
        end
        
        return interactable.MarketStalls
    end)
    
    if success then
        return result
    else
        warn("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ MarketStalls: " .. tostring(result))
        return nil
    end
end

-- –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∞–Ω—Ç–∏-AFK (–Ω–µ–∑–∞–º–µ—Ç–Ω—ã–π –¥–ª—è –∏–≥—Ä—ã)
local function setupAntiAFK()
    if isTradeWorld then
        print("üö´ –ê–Ω—Ç–∏-AFK –æ—Ç–∫–ª—é—á–µ–Ω –≤ —Ç—Ä–µ–π–¥-–º–∏—Ä–µ")
        return nil
    end
    
    local lastActionTime = tick()
    local connection
    
    connection = game:GetService("RunService").Heartbeat:Connect(function()
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ (—Ä–∞–∑ –≤ 30 —Å–µ–∫—É–Ω–¥)
        if tick() - lastActionTime < 30 then
            return
        end
        
        lastActionTime = tick()
        
        -- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –Ω–µ–∑–∞–º–µ—Ç–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
        VirtualInputManager:SendMouseMoveEvent(1, 1, game:GetService("Workspace"))
        task.wait(0.1)
        VirtualInputManager:SendMouseMoveEvent(-1, -1, game:GetService("Workspace"))
        
        -- –û—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–æ–µ –Ω–∞–∂–∞—Ç–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥–≤–∏–∂–µ–Ω–∏–µ
        VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Space, false, game)
        task.wait(0.05)
        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Space, false, game)
        
        print("üîÑ –ê–Ω—Ç–∏-AFK: –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –Ω–µ–∑–∞–º–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ")
    end)
    
    return connection
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –æ–Ω–ª–∞–π–Ω–æ–º
local function findBestServer(placeId)
    print("üîç –ü–æ–∏—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –æ–Ω–ª–∞–π–Ω–æ–º –¥–ª—è placeId: " .. placeId)
    
    local success, servers = pcall(function()
        local response = request({
            Url = "https://games.roblox.com/v1/games/" .. placeId .. "/servers/Public?sortOrder=Desc&limit=100",
            Method = "GET"
        })
        
        if response and response.Body then
            local data = HttpService:JSONDecode(response.Body)
            return data.data
        end
        return {}
    end)
    
    if not success then
        warn("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤")
        return nil
    end
    
    local bestServer = nil
    local maxPlayers = 0
    local currentJobId = game.JobId
    
    for _, server in ipairs(servers) do
        if server.playing and server.id ~= currentJobId then
            if server.playing > maxPlayers then
                maxPlayers = server.playing
                bestServer = server
            end
        end
    end
    
    if bestServer then
        print("üèÜ –ù–∞–π–¥–µ–Ω –ª—É—á—à–∏–π —Å–µ—Ä–≤–µ—Ä: " .. bestServer.id .. " —Å " .. bestServer.playing .. " –∏–≥—Ä–æ–∫–∞–º–∏")
        return bestServer
    else
        print("‚ö†Ô∏è –ü–æ–¥—Ö–æ–¥—è—â–∏–π —Å–µ—Ä–≤–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å–ª—É—á–∞–π–Ω—ã–π")
        return nil
    end
end

-- –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏ –Ω–∞ –ª—É—á—à–∏–π —Å–µ—Ä–≤–µ—Ä
local function teleportToBestServer(targetPlaceId)
    local bestServer = findBestServer(targetPlaceId)
    
    if bestServer then
        print("üöÄ –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –æ–Ω–ª–∞–π–Ω–æ–º: " .. bestServer.playing .. " –∏–≥—Ä–æ–∫–æ–≤")
        local success, errorMsg = pcall(function()
            TeleportService:TeleportToPlaceInstance(targetPlaceId, bestServer.id, localPlayer)
        end)
        
        if success then
            print("‚úÖ –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è –Ω–∞—á–∞—Ç–∞ —É—Å–ø–µ—à–Ω–æ!")
            return true
        else
            warn("‚ùå –û—à–∏–±–∫–∞ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏: " .. tostring(errorMsg))
            return false
        end
    else
        -- –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ª—É—á—à–∏–π —Å–µ—Ä–≤–µ—Ä, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ã—á–Ω—É—é —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—é
        print("üîÑ –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ã—á–Ω—É—é —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—é")
        local success, errorMsg = pcall(function()
            TeleportService:Teleport(targetPlaceId, localPlayer)
        end)
        
        if success then
            print("‚úÖ –û–±—ã—á–Ω–∞—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è –Ω–∞—á–∞—Ç–∞!")
            return true
        else
            warn("‚ùå –û—à–∏–±–∫–∞ –æ–±—ã—á–Ω–æ–π —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏: " .. tostring(errorMsg))
            return false
        end
    end
end

-- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–æ–∏—Å–∫ AnchorPart –ø–æ CFrame (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –º–∏—Ä–æ–≤)
local function findAnchorPartByCFrame(targetCFrame)
    if isTradeWorld then
        return nil
    end
    
    local marketStalls = getMarketStalls()
    if not marketStalls then
        return nil
    end
    
    for _, child in pairs(marketStalls:GetChildren()) do
        if child:IsA("BasePart") and child.Name == "AnchorPart" then
            local positionDiff = (child.CFrame.Position - targetCFrame.Position).Magnitude
            if positionDiff < 1 then
                return child
            end
        end
    end
    return nil
end

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ª–∞–≤–æ–∫ –≤ –º–∏—Ä–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –º–∏—Ä–æ–≤)
local function checkWorldForStalls()
    if isTradeWorld then
        return false
    end
    
    local marketStalls = getMarketStalls()
    if not marketStalls then
        print("üåç –í —ç—Ç–æ–º –º–∏—Ä–µ –Ω–µ—Ç –ª–∞–≤–æ–∫, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª...")
        return false
    end
    
    -- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ AnchorPart
    local hasAnchorParts = false
    for _, child in pairs(marketStalls:GetChildren()) do
        if child:IsA("BasePart") and child.Name == "AnchorPart" then
            hasAnchorParts = true
            break
        end
    end
    
    if not hasAnchorParts then
        print("üîç AnchorPart –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ MarketStalls")
        return false
    end
    
    return true
end

-- –î–û–ë–ê–í–õ–ï–ù–ê: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏ —Å —É—á–µ—Ç–æ–º –º–æ–Ω–µ—Ç - –ò–°–ü–†–ê–í–õ–ï–ù–û
local function checkTeleportConditions()
    local currentPlayers = #Players:GetPlayers()
    local currentPlaceId = game.PlaceId
    local coins = getCoins()
    
    print("üìç –¢–µ–∫—É—â–∏–π –ø–ª–µ–π—Å ID:", currentPlaceId)
    print("üë• –ò–≥—Ä–æ–∫–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:", currentPlayers)
    print("üí∞ –ú–æ–Ω–µ—Ç —É –∏–≥—Ä–æ–∫–∞:", coins)
    
    -- –î–û–ë–ê–í–õ–ï–ù–û: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –º–æ–Ω–µ—Ç
    if coins >= COINS_LIMIT_FOR_NORMAL_WORLD then
        print("üí∞üí∞üí∞ –õ–ò–ú–ò–¢ –ú–û–ù–ï–¢ –î–û–°–¢–ò–ì–ù–£–¢! ("..coins.." >= "..COINS_LIMIT_FOR_NORMAL_WORLD..")")
        
        -- –ï—Å–ª–∏ –º—ã –≤ –¢–†–ï–ô–î-–ú–ò–†–ï (14119723130) –∏ –¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏–º–∏—Ç–∞ –º–æ–Ω–µ—Ç
        if currentPlaceId == 14119723130 then
            print("‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç, –æ—Å—Ç–∞–µ–º—Å—è –≤ —Ç—Ä–µ–π–¥-–º–∏—Ä–µ")
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä —Å –º–∞–ª—ã–º –æ–Ω–ª–∞–π–Ω–æ–º
            if currentPlayers <= 20 then
                print("üîÅ –ú–∞–ª–æ –∏–≥—Ä–æ–∫–æ–≤ ("..currentPlayers.."), –∏—â–µ–º –ª—É—á—à–∏–π —Å–µ—Ä–≤–µ—Ä –≤ —Ç—Ä–µ–π–¥-–º–∏—Ä–µ...")
                return teleportToBestServer(14119723130)
            end
            return false  -- –ù–µ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ–º—Å—è –≤ –æ–±—ã—á–Ω—ã–π –º–∏—Ä
        end
        
        -- –ï—Å–ª–∏ –º—ã –≤ –û–ë–´–ß–ù–û–ú –ú–ò–†–ï (5233782396) —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–æ–Ω–µ—Ç
        if currentPlaceId == 5233782396 then
            print("‚úÖ –û—Å—Ç–∞–µ–º—Å—è –≤ –æ–±—ã—á–Ω–æ–º –º–∏—Ä–µ (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç)")
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä —Å –º–∞–ª—ã–º –æ–Ω–ª–∞–π–Ω–æ–º
            if currentPlayers <= 20 then
                print("üîÅ –ú–∞–ª–æ –∏–≥—Ä–æ–∫–æ–≤ ("..currentPlayers.."), –∏—â–µ–º –ª—É—á—à–∏–π —Å–µ—Ä–≤–µ—Ä –≤ –æ–±—ã—á–Ω–æ–º –º–∏—Ä–µ...")
                return teleportToBestServer(5233782396)
            end
            return false  -- –ù–µ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ–º—Å—è –≤ —Ç—Ä–µ–π–¥-–º–∏—Ä
        end
    end
    
    -- –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –ø–ª–µ–π—Å = 14119723130 (–¢–†–ï–ô–î-–ú–ò–†) –∏ –º–æ–Ω–µ—Ç –ú–ï–ù–¨–®–ï –ª–∏–º–∏—Ç–∞
    if currentPlaceId == 14119723130 and coins < COINS_LIMIT_FOR_NORMAL_WORLD then
        print("üöÄ –ú–æ–Ω–µ—Ç –º–µ–Ω—å—à–µ –ª–∏–º–∏—Ç–∞, –∏—â–µ–º –ª—É—á—à–∏–π —Å–µ—Ä–≤–µ—Ä –≤ –¢–†–ï–ô–î-–ú–ò–†–ï...")
        -- –û—Å—Ç–∞–µ–º—Å—è –≤ —Ç—Ä–µ–π–¥-–º–∏—Ä–µ, –Ω–æ –∏—â–µ–º –ª—É—á—à–∏–π —Å–µ—Ä–≤–µ—Ä
        if currentPlayers <= 20 then
            return teleportToBestServer(14119723130)
        end
        return false
    end
    
    -- –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –ø–ª–µ–π—Å = 5233782396 (–û–ë–´–ß–ù–´–ô –ú–ò–†) –∏ –º–æ–Ω–µ—Ç –ú–ï–ù–¨–®–ï –ª–∏–º–∏—Ç–∞
    if currentPlaceId == 5233782396 and coins < COINS_LIMIT_FOR_NORMAL_WORLD then
        print("üöÄ –ú–æ–Ω–µ—Ç –º–µ–Ω—å—à–µ –ª–∏–º–∏—Ç–∞, –∏—â–µ–º –ª—É—á—à–∏–π —Å–µ—Ä–≤–µ—Ä –≤ –û–ë–´–ß–ù–û–ú –ú–ò–†–ï...")
        if currentPlayers <= 20 then
            return teleportToBestServer(5233782396)
        end
        return false
    end
    
    return false
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–Ω—è—Ç–∏—è –ª–∞–≤–∫–∏ (–±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏)
local function claimStall(anchorPart)
    if not anchorPart or isTradeWorld then
        return false
    end
    
    local success, result = pcall(function()
        -- –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–Ω—è—Ç—å –ª–∞–≤–∫—É
        ClaimStall:FireServer(anchorPart)
        return true
    end)
    
    if success then
        print("‚úÖ –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–Ω—è—Ç—å –ª–∞–≤–∫—É")
        return true
    else
        warn("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–Ω—è—Ç–∏–∏ –ª–∞–≤–∫–∏: " .. tostring(result))
        return false
    end
end

-- –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–Ω—è—Ç–∏—è –ª–∞–≤–æ–∫ (–≤–µ—á–Ω—ã–π —Ü–∏–∫–ª)
local function claimStallsForever()
    if isTradeWorld then
        return
    end
    
    print("‚ôæÔ∏è –ó–∞–ø—É—Å–∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∑–∞–Ω—è—Ç–∏—è –ª–∞–≤–æ–∫...")
    
    while true do
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏—è –¥–ª—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏
        if checkTeleportConditions() then
            print("üîÑ –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞, –ø—Ä–µ—Ä—ã–≤–∞–µ–º –∑–∞–Ω—è—Ç–∏–µ –ª–∞–≤–æ–∫...")
            break
        end
        
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –ª–∞–≤–∫–∏ –≤ —ç—Ç–æ–º –º–∏—Ä–µ
        if not checkWorldForStalls() then
            print("‚è∏Ô∏è –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª –∑–∞–Ω—è—Ç–∏–π –ª–∞–≤–æ–∫ (–º–∏—Ä –±–µ–∑ –ª–∞–≤–æ–∫)")
            wait(2)
            continue
        end
        
        -- –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –ø–æ –≤—Å–µ–º –ª–∞–≤–∫–∞–º
        for i, stallCFrame in ipairs(stallCFrames) do
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –ª–∞–≤–∫–æ–π
            if checkTeleportConditions() then
                print("üîÑ –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞, –ø—Ä–µ—Ä—ã–≤–∞–µ–º –∑–∞–Ω—è—Ç–∏–µ –ª–∞–≤–æ–∫...")
                break
            end
            
            local anchorPart = findAnchorPartByCFrame(stallCFrame)
            
            if anchorPart then
                claimStall(anchorPart)
            else
                print("‚ùå –õ–∞–≤–∫–∞ #"..i.." –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
            end
            
            wait(0.1) -- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
        end
        
        -- –û—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∞—è –ø–∞—É–∑–∞ –º–µ–∂–¥—É –ø–æ–ª–Ω—ã–º–∏ —Ü–∏–∫–ª–∞–º–∏
        wait(0.5)
    end
end

-- –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
local function main()
    print("üéØ –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω!")
    print("üí∞ –õ–∏–º–∏—Ç –º–æ–Ω–µ—Ç –¥–ª—è –æ—Å—Ç–∞—Ç–∫–∞ –≤ –æ–±—ã—á–Ω–æ–º –º–∏—Ä–µ: " .. COINS_LIMIT_FOR_NORMAL_WORLD)
    print("‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è FPS –∞–∫—Ç–∏–≤–Ω–∞: "..MAX_FPS.." FPS (–≤ —Ñ–æ–∫—É—Å–µ), "..MIN_FPS.." FPS (–Ω–µ –≤ —Ñ–æ–∫—É—Å–µ)")
    print("üé® –†–µ–Ω–¥–µ—Ä–∏–Ω–≥: "..(RENDER and "–≤–∫–ª—é—á–µ–Ω" or "–≤—ã–∫–ª—é—á–µ–Ω"))
    
    if isTradeWorld then
        print("üîí –†–ï–ñ–ò–ú –¢–†–ï–ô–î-–ú–ò–†–ê (14119723130): –í–∫–ª—é—á–µ–Ω CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫-–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å")
        print("üìä CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç")
        print("üîó –í–µ–±—Ö—É–∫: " .. COS_STATS_WEBHOOK)
    elseif isNormalWorld then
        print("üåç –†–ï–ñ–ò–ú –û–ë–´–ß–ù–û–ì–û –ú–ò–†–ê (5233782396): –í–∫–ª—é—á–µ–Ω –ø—Ä–æ—Å—Ç–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫-–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å")
        print("üìä –ü—Ä–æ—Å—Ç–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç")
        print("üîó –í–µ–±—Ö—É–∫: " .. DISCORD_WEBHOOK)
    end
    
    local antiAFKConnection = setupAntiAFK()
    
    -- –î–û–ë–ê–í–õ–ï–ù–û: –ó–∞–ø—É—Å–∫–∞–µ–º CoS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ (—Ç–æ–ª—å–∫–æ –≤ —Ç—Ä–µ–π–¥-–º–∏—Ä–µ)
    if isTradeWorld then
        coroutine.wrap(startCoSStatsTimer)()
    elseif isNormalWorld then
        -- –í –æ–±—ã—á–Ω–æ–º –º–∏—Ä–µ –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Å—Ç–æ–π –≤–µ–±—Ö—É–∫ –∏ –∑–∞–Ω—è—Ç–∏–µ –ª–∞–≤–æ–∫
        coroutine.wrap(startWebhookTimer)()
        claimStallsForever()
    end
    
    -- –í —Ç—Ä–µ–π–¥-–º–∏—Ä–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—é –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    if isTradeWorld then
        while true do
            if checkTeleportConditions() then
                break
            end
            wait(1)
        end
    end
    
    if antiAFKConnection then
        antiAFKConnection:Disconnect()
    end
    
    print("üìã –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏...")
end

-- –ó–∞–ø—É—Å–∫
local success, errorMsg = pcall(main)
if not success then
    warn("üí• –û—à–∏–±–∫–∞: "..errorMsg)
    print("üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...")
    wait(5)
    main()
end
